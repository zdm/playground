# RPC v1

### API connect URLs

- API HTTP URL: `http://localhost/api/`
- API WebSockets URL: `ws://localhost/api/`

<!-- tabs:start -->

#### **WebSockets**

```javascript
import Api from "@c0rejs/core/api";

const api = new Api( "ws://localhost/api/" );
```

#### **HTTP**

```javascript
import Api from "@c0rejs/core/api";

const api = new Api( "http://localhost/api/" );
```

<!-- tabs:end -->

## PostgreSQL

### Get WAL file

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/postgresql/get-wal", server_names );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/postgresql/get-wal"
```

<!-- tabs:end -->

- `server_names`

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "anyOf": [
        {
            "type": "string",
            "format": "nginx-server-name"
        },
        {
            "type": "array",
            "items": {
                "type": "string",
                "format": "nginx-server-name"
            },
            "minItems": 1,
            "uniqueItems": true
        }
    ]
}
```

#### **YAML**

```yaml
anyOf:
  - type: string
    format: nginx-server-name
  - type: array
    items:
      type: string
      format: nginx-server-name
    minItems: 1
    uniqueItems: true
```

<!-- tabs:end -->

</details>

## Administration

### Reset root user password

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/administration/reset-root-password", password? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/administration/reset-root-password"
```

<!-- tabs:end -->

- `password?` {string}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string"
}
```

#### **YAML**

```yaml
type: string
```

<!-- tabs:end -->

</details>

### Revoke current encryption key

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/administration/revoke-key" );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/administration/revoke-key"
```

<!-- tabs:end -->

### Revoke current master key

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/administration/revoke-master-key", master_key? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/administration/revoke-master-key"
```

<!-- tabs:end -->

- `master_key?` {string}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string"
}
```

#### **YAML**

```yaml
type: string
```

<!-- tabs:end -->

</details>

## Storage

### Upload file to the storage

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/storage/upload-file", path, file, options? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/storage/upload-file"
```

<!-- tabs:end -->

- `path` {string}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string",
    "path": {
        "root": false,
        "folder": false
    }
}
```

#### **YAML**

```yaml
type: string
path:
  root: false
  folder: false
```

<!-- tabs:end -->

</details>

- `file` {File} Maximim file size: `NaN` bytes.

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "file": {
        "maxSize": "50 GB"
    }
}
```

#### **YAML**

```yaml
file:
  maxSize: 50 GB
```

<!-- tabs:end -->

</details>

- `options?` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "cwd": {
            "type": "string",
            "path": {
                "root": true,
                "folder": false
            }
        },
        "lastModified": {
            "type": "string",
            "format": "date-time"
        },
        "contentType": {
            "type": "string"
        },
        "cacheControl": {
            "type": "string"
        },
        "contentDisposition": {
            "type": "string"
        },
        "expires": {
            "type": "string",
            "format": "date-time"
        },
        "maxAge": {
            "type": "string",
            "format": "interval"
        },
        "inactiveMaxAge": {
            "type": "string",
            "format": "interval"
        },
        "encrypt": {
            "type": "boolean"
        }
    },
    "additionalProperties": false
}
```

#### **YAML**

```yaml
type: object
properties:
  cwd:
    type: string
    path:
      root: true
      folder: false
  lastModified:
    type: string
    format: date-time
  contentType:
    type: string
  cacheControl:
    type: string
  contentDisposition:
    type: string
  expires:
    type: string
    format: date-time
  maxAge:
    type: string
    format: interval
  inactiveMaxAge:
    type: string
    format: interval
  encrypt:
    type: boolean
additionalProperties: false
```

<!-- tabs:end -->

</details>

### Chheck file exists in the storage

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/storage/file-exists", path, options? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/storage/file-exists"
```

<!-- tabs:end -->

- `path` {string}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string",
    "path": {
        "root": false,
        "folder": false
    }
}
```

#### **YAML**

```yaml
type: string
path:
  root: false
  folder: false
```

<!-- tabs:end -->

</details>

- `options?` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "cwd": {
            "type": "string",
            "path": {
                "root": true,
                "folder": false
            }
        },
        "checkImage": {
            "type": "boolean"
        }
    },
    "additionalProperties": false
}
```

#### **YAML**

```yaml
type: object
properties:
  cwd:
    type: string
    path:
      root: true
      folder: false
  checkImage:
    type: boolean
additionalProperties: false
```

<!-- tabs:end -->

</details>

### Get file meta data

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/storage/get-file-metadata", path, options? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/storage/get-file-metadata"
```

<!-- tabs:end -->

- `path` {string}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string",
    "path": {
        "root": false,
        "folder": false
    }
}
```

#### **YAML**

```yaml
type: string
path:
  root: false
  folder: false
```

<!-- tabs:end -->

</details>

- `options?` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "cwd": {
            "type": "string",
            "path": {
                "root": true,
                "folder": false
            }
        },
        "checkImage": {
            "type": "boolean"
        }
    },
    "additionalProperties": false
}
```

#### **YAML**

```yaml
type: object
properties:
  cwd:
    type: string
    path:
      root: true
      folder: false
  checkImage:
    type: boolean
additionalProperties: false
```

<!-- tabs:end -->

</details>

### Search files using glob patterns

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/storage/glob", patterns, options? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/storage/glob"
```

<!-- tabs:end -->

- `patterns`

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "anyOf": [
        {
            "type": "string",
            "format": "glob-pattern"
        },
        {
            "type": "array",
            "items": {
                "type": "string",
                "format": "glob-pattern"
            },
            "minItems": 1
        }
    ]
}
```

#### **YAML**

```yaml
anyOf:
  - type: string
    format: glob-pattern
  - type: array
    items:
      type: string
      format: glob-pattern
    minItems: 1
```

<!-- tabs:end -->

</details>

- `options?` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "cwd": {
            "type": "string",
            "path": {
                "root": true,
                "folder": false
            }
        }
    },
    "additionalProperties": false
}
```

#### **YAML**

```yaml
type: object
properties:
  cwd:
    type: string
    path:
      root: true
      folder: false
additionalProperties: false
```

<!-- tabs:end -->

</details>

### Delete files using glob patterns

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/storage/delete-files", patterns, options? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/storage/delete-files"
```

<!-- tabs:end -->

- `patterns`

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "anyOf": [
        {
            "type": "string",
            "format": "glob-pattern"
        },
        {
            "type": "array",
            "items": {
                "type": "string",
                "format": "glob-pattern"
            },
            "minItems": 1
        }
    ]
}
```

#### **YAML**

```yaml
anyOf:
  - type: string
    format: glob-pattern
  - type: array
    items:
      type: string
      format: glob-pattern
    minItems: 1
```

<!-- tabs:end -->

</details>

- `options?` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "cwd": {
            "type": "string",
            "path": {
                "root": true,
                "folder": false
            }
        }
    },
    "additionalProperties": false
}
```

#### **YAML**

```yaml
type: object
properties:
  cwd:
    type: string
    path:
      root: true
      folder: false
additionalProperties: false
```

<!-- tabs:end -->

</details>

## Test

### Bench

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/test/bench" );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/test/bench"
```

<!-- tabs:end -->

### Test

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/test/test", args?, test? );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/test/test"
```

<!-- tabs:end -->

- `args?` {string} Parameter description. Playwright enables fast, reliable and capable automation across all modern browsers. This guide covers those key differentiators to help you decide on the right tool for your automated tests.

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "string"
}
```

#### **YAML**

```yaml
type: string
```

<!-- tabs:end -->

</details>

- `test?` {Object} Test parameter.

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object"
}
```

#### **YAML**

```yaml
type: object
```

<!-- tabs:end -->

</details>

Playwright methods might throw errors if they are unable to fulfill a request. For example, page.waitForSelector(selector\[, options]) might fail if the selector doesn't match any nodes during the given timeframe.

For certain types of errors Playwright uses specific error classes. These classes are available via playwright.errors.

### Test upload

<!-- tabs:start -->

#### **JavaScript**

```javascript
const res = await api.call( "/v1/test/upload", data );
```

#### **Shell**

```sh
curl \
    -H "Authorization: Bearer <YOUR-API-TOKEN>" \
    "http://localhost/api/v1/test/upload"
```

<!-- tabs:end -->

- `data` {Object}

<details>
    <summary>JSON schema</summary>

<!-- tabs:start -->

#### **JSON**

```json
{
    "type": "object",
    "properties": {
        "file": {
            "file": {
                "maxSize": "50 MB",
                "contentType": [
                    "text/plain",
                    "text/html"
                ]
            }
        },
        "options": {
            "type": "object"
        }
    },
    "additionalProperties": false,
    "required": [
        "file"
    ]
}
```

#### **YAML**

```yaml
type: object
properties:
  file:
    file:
      maxSize: 50 MB
      contentType:
        - text/plain
        - text/html
  options:
    type: object
additionalProperties: false
required:
  - file
```

<!-- tabs:end -->

</details>
